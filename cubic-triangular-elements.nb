(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68918,       1592]
NotebookOptionsPosition[     67350,       1562]
NotebookOutlinePosition[     67726,       1578]
CellTagsIndexPosition[     67683,       1575]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"triangle", " ", "=", " ", 
   RowBox[{"Triangle", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary", "=", 
   RowBox[{
    RowBox[{"RegionBoundary", "[", "triangle", "]"}], "\[LeftDoubleBracket]", 
    "1", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodes", "=", 
   RowBox[{"Catenate", "[", 
    RowBox[{"Most", "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["j", "3"]}], ")"}], 
         RowBox[{
         "boundary", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
         "+", 
        RowBox[{
         FractionBox["j", "3"], 
         RowBox[{"boundary", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nodes", ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "3"], ",", 
      FractionBox["1", "3"]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "@", "nodes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
  RowBox[{"nodes", ",", "\[IndentingNewLine]", 
   RowBox[{"LabelingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"nodes", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"PointSize", "\[Rule]", "Large"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.85591696311981*^9, 3.8559170074066153`*^9}, {
   3.8559171420064907`*^9, 3.855917275754678*^9}, 
   3.855917333529746*^9},ExpressionUUID->"85d77932-1ad2-44d7-a984-\
1bd4727fd28b"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{0., 0.}, {0.3333333333333333, 0.}, {0.6666666666666666, 0.}, {
      1., 0.}, {0.6666666666666666, 0.3333333333333333}, {0.3333333333333333, 
      0.6666666666666666}, {0., 1.}, {0., 0.6666666666666666}, {0., 
      0.3333333333333333}, {0.3333333333333333, 
      0.3333333333333333}}]}, {}}, {}, {}, {{}, {}}, {{GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, {0., 0.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.3333333333333333, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.3333333333333333, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"2"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.6666666666666666, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.6666666666666666, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.6666666666666666, 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.6666666666666666, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"3"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.6666666666666666, 0.}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{0., 4.}, {1., 0.}], Offset[{0., 4.}, {1., 0.}], 
          Offset[{0., 6.}, {1., 0.}], Offset[{0., 6.}, {1., 0.}], 
          Offset[{0., 8.}, {1., 0.}], Offset[{0., 10.}, {1., 0.}], 
          Offset[{0., 12.}, {1., 0.}], Offset[{0., 12.}, {1., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{0., 4.}, {1., 0.}], Offset[{0., 4.}, {1., 0.}], 
          Offset[{0., 6.}, {1., 0.}], Offset[{0., 6.}, {1., 0.}], 
          Offset[{0., 8.}, {1., 0.}], Offset[{0., 10.}, {1., 0.}], 
          Offset[{0., 12.}, {1., 0.}], Offset[{0., 12.}, {1., 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{10.999999999999998`, 27.000000000000004`}, {1., 0.}], 
          Offset[{11.000000000000002`, 12.000000000000004`}, {1., 0.}], 
          Offset[{-10.999999999999998`, 11.999999999999996`}, {1., 0.}], 
          Offset[{-11.000000000000002`, 26.999999999999996`}, {1., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"4"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], Offset[{0., 19.5}, {1., 0.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"5"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.6666666666666666, 0.3333333333333333}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"6"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.6666666666666666}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 1.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 1.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 1.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 1.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"7"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, {0., 1.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 
           0.6666666666666666}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 
           0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"8"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0., 0.6666666666666666}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 
           0.3333333333333333}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 
           0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"9"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0., 0.3333333333333333}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{38.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{38.494480483301835`, 1.604059656000313}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.604059656000306}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"10"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{24.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.3333333333333333}], {0, 0}]}]}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Small,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.08]}, {
     Scaled[0.02], 
     Scaled[0.12]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8559172092326975`*^9, 3.8559172772199097`*^9}, 
   3.855917334289918*^9, 3.8559183587819247`*^9, 3.8559997084137044`*^9, 
   3.857739121457373*^9},ExpressionUUID->"3e65f29f-786f-4785-b06b-\
53e403b396e9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"standardBasisFunctions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "2"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "2"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "3"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "3"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "2"], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       SuperscriptBox[
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "2"]}], "&"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
       "\[RightDoubleBracket]"}], "[", 
      RowBox[{"nodes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["H", "inv"], "=", 
   RowBox[{"Inverse", "@", "H"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    SuperscriptBox["H", "T"], "inv"], "=", 
   RowBox[{"Transpose", "@", 
    SubscriptBox["H", "inv"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8559173600415964`*^9, 
  3.855917389511634*^9}},ExpressionUUID->"0ac08ff6-5570-4f01-bea9-\
69a861f03949"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "list", " ", "of", " ", "shape", " ", "functions"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPsi]", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", "=", "i"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox[
               SuperscriptBox["H", "T"], "inv"], "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{
              "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], "@", "#"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Through", "[", 
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "//", " ", 
     "MatrixForm"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.855917614145997*^9, 3.855917620843938*^9}, {
  3.8559180511274242`*^9, 3.8559180546639385`*^9}, {3.8559996148585033`*^9, 
  3.855999620459361*^9}},ExpressionUUID->"e0938c9a-6fc4-42f7-bc29-\
7a01acda8d4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "For", " ", "proof", " ", "that", " ", "this", " ", "is", " ", "an", " ", 
     "interpolating", " ", "basis"}], " ", "-", " ", 
    RowBox[{"this", " ", "matrix", " ", "has", " ", "components", " ", 
     SubscriptBox["\[CapitalPsi]", "i"], 
     RowBox[{"(", 
      SubscriptBox["nodes", "j"], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Through", "[", 
        RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "]"}], "&"}], ",", 
      "nodes"}], "]"}], " ", "//", " ", "MatrixForm"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8559174308812513`*^9, 3.8559174317269907`*^9}, 
   3.855918059690153*^9, {3.8559996128223515`*^9, 3.855999613624449*^9}, {
   3.8577396140973825`*^9, 
   3.8577396156971*^9}},ExpressionUUID->"613b375c-9817-4d46-8776-\
002d5eeb225e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "NIntegrate", " ", "is", " ", "bad", " ", "in", " ", "our", " ", "case", 
    " ", "since", " ", "it", " ", "does", " ", "a", " ", "lot", " ", "of", 
    " ", "unnecessary", " ", "work"}], " ", "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "know", " ", "that", " ", "we", " ", "are", " ", "using", " ", 
     "polynomials"}], " ", "=", 
    RowBox[{">", " ", 
     RowBox[{
     "quick", " ", "exact", " ", "gaussian", " ", "quadrature", " ", 
      "formulas"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"locWeights", "=", 
     RowBox[{"N", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          FractionBox["3", "120"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          FractionBox["3", "120"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          FractionBox["3", "120"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
          FractionBox["8", "120"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            FractionBox["1", "2"]}], "}"}], ",", 
          FractionBox["8", "120"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "2"], ",", 
            FractionBox["1", "2"]}], "}"}], ",", 
          FractionBox["8", "120"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "3"], ",", 
            FractionBox["1", "3"]}], "}"}], ",", 
          FractionBox["27", "120"]}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numericIntegrate", "[", "fSymb_", "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"locWeights", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
       RowBox[{"(", 
        RowBox[{"fSymb", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Xi]", "->", 
            RowBox[{"locWeights", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"\[Eta]", "->", 
            RowBox[{"locWeights", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
           "}"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "locWeights"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.85591918259512*^9}, {3.8559759719770875`*^9, 
   3.855975972543495*^9}, {3.855999881682604*^9, 3.855999893546773*^9}, {
   3.855999931360421*^9, 3.8559999335518575`*^9}, {3.8559999822938375`*^9, 
   3.856000004323064*^9}, {3.8577375017923703`*^9, 3.857737775348578*^9}, {
   3.857737817606256*^9, 3.8577378486168995`*^9}, {3.857738055664812*^9, 
   3.857738097244771*^9}, {3.8577382976127706`*^9, 3.8577383122788525`*^9}, {
   3.8577394593688607`*^9, 
   3.857739611761091*^9}},ExpressionUUID->"e4edd004-70fb-4f15-b1e5-\
4492d188c404"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Now", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
    " ", "is", " ", "what", " ", "in", " ", "the", " ", "linear", " ", "case",
     " ", "is", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
    " ", "and", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
    " ", "in", " ", "the", " ", "linear", " ", "case", " ", "is", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
        "-", 
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
        "-", 
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"7", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"7", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.85591918259512*^9}, {3.8559759719770875`*^9, 
   3.855975972543495*^9}, {3.855999881682604*^9, 3.855999893546773*^9}, {
   3.855999931360421*^9, 3.8559999335518575`*^9}, {3.8559999822938375`*^9, 
   3.856000004323064*^9}, 3.8577375017923703`*^9, {3.8577396282913666`*^9, 
   3.857739628730404*^9}},ExpressionUUID->"a66f0b6b-ce18-40ce-ac1b-\
7d6b5e655dc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"{", 
    RowBox[{"Through", "[", 
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]T", "=", 
   RowBox[{"Transpose", "@", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"innerMass", "=", 
   RowBox[{"numericIntegrate", "[", 
    RowBox[{"\[Psi]T", ".", "\[Psi]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localMass", "[", 
   RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Abs", "@", 
    RowBox[{"Det", "@", 
     RowBox[{"J", "[", "elementNodes", "]"}]}]}], "innerMass"}]}]}], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.85591918259512*^9}, {3.8559759719770875`*^9, 
   3.855975972543495*^9}, {3.855999881682604*^9, 3.855999893546773*^9}, {
   3.855999931360421*^9, 3.8559999335518575`*^9}, {3.8559999822938375`*^9, 
   3.856000012267234*^9}, {3.8560001111516385`*^9, 3.856000119923855*^9}, {
   3.8577390532702937`*^9, 
   3.857739060796644*^9}},ExpressionUUID->"8004afab-6467-4451-ba45-\
6b01a26b6165"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"grad\[Psi]", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grad\[Psi]T", "=", 
     RowBox[{"Transpose", "@", "grad\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "As", " ", "grad\[Psi]", " ", "is", " ", "not", " ", "a", " ", "constant",
      " ", "in", " ", "the", " ", "nonlinear", " ", "case", " ", "we", " ", 
     "can", " ", "no", " ", "longer", " ", "simplify", " ", "the", " ", 
     "integration"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localStiffness", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Abs", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"J", "[", "elementNodes", "]"}]}]}]], 
     RowBox[{"numericIntegrate", "[", 
      RowBox[{"grad\[Psi]T", ".", 
       RowBox[{"Transpose", "@", 
        RowBox[{"B", "[", "elementNodes", "]"}]}], ".", 
       RowBox[{"B", "[", "elementNodes", "]"}], ".", "grad\[Psi]"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.855919171474184*^9}, {3.855975982809389*^9, 
   3.8559760004117975`*^9}, {3.8559986970941067`*^9, 3.855998720293186*^9}, {
   3.8559994185221596`*^9, 3.8559994607568784`*^9}, {3.8559994930764523`*^9, 
   3.855999493276621*^9}, {3.8559996928770337`*^9, 3.8559996978097773`*^9}, {
   3.856000007834848*^9, 3.8560000089216976`*^9}, {3.857739067087381*^9, 
   3.8577390734456186`*^9}},ExpressionUUID->"632edba4-611e-4898-9e82-\
37a4c2b26ac9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Allows", " ", "us", " ", "to", " ", "use", " ", "regular", " ", 
    "triangulation", " ", "and", " ", "construct", " ", "the", " ", "extra", 
    " ", "nodes", " ", "during", " ", "the", " ", "matrices", " ", 
    "creation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Looks", " ", "quite", " ", "ugly"}], " ", "-", " ", 
    RowBox[{
    "maybe", " ", "a", " ", "different", " ", "order", " ", "of", " ", 
     "nodes", " ", "would", " ", "be", " ", "more", " ", "computationally", 
     " ", "efficient"}], " ", "-", " ", 
    RowBox[{
    "starting", " ", "from", " ", "one", " ", "vertex", " ", "and", " ", 
     "iterating", " ", "to", " ", "the", " ", "opposite", " ", "side"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Notice", " ", "that", " ", "in", " ", "such", " ", "cases", " ", "it", 
     " ", "would", " ", "be", " ", "better", " ", "to", " ", "permute", " ", 
     "the", " ", "\[CapitalPsi]", " ", "function", " ", "array", " ", 
     RowBox[{"(", 
      RowBox[{"for", " ", "practically", " ", "no", " ", "cost"}], ")"}]}], 
    ",", " ", 
    RowBox[{
    "rather", " ", "than", " ", "use", " ", "a", " ", "quicker", " ", "loop", 
     " ", "and", " ", "permute", " ", "the", " ", "coordinates"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getFullNodes", "[", 
    RowBox[{"threeElementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"enlargedNodes", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"threeElementNodes", ",", 
          RowBox[{
          "threeElementNodes", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "]"}]}], ",", "fullNodes"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullNodes", "=", 
       RowBox[{"Catenate", "[", 
        RowBox[{"Most", "/@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox["j", "3"]}], ")"}], 
             RowBox[{
             "enlargedNodes", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], "+", 
            RowBox[{
             FractionBox["j", "3"], 
             RowBox[{"enlargedNodes", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Append", "[", 
       RowBox[{"fullNodes", ",", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"N", "@", 
           FractionBox["1", "3"]}], 
          RowBox[{"fullNodes", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.857738314994308*^9, 3.8577383296490164`*^9}, {
  3.8577383613567038`*^9, 3.8577384675465612`*^9}, {3.8577385307550535`*^9, 
  3.8577385539031773`*^9}, {3.8577385914188504`*^9, 3.8577387982071266`*^9}, {
  3.8577388325706387`*^9, 3.857738849675744*^9}, {3.8577389081142955`*^9, 
  3.8577390029294496`*^9}, {3.8577392116399665`*^9, 3.8577392349496326`*^9}, {
  3.8577396992213974`*^9, 
  3.8577398024964647`*^9}},ExpressionUUID->"bf26baa3-5b1e-4253-915d-\
0f348b66b415"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculate", " ", "for", " ", "a", " ", "specific", " ", "element"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"spElNodes", "=", 
     RowBox[{"N", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          FractionBox["1", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "1"}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elNodes", "=", 
     RowBox[{"getFullNodes", "@", "spElNodes"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localMass", "[", "elNodes", "]"}], " ", "//", "MatrixForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localStiffness", "[", "elNodes", "]"}], " ", "//", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.8577389925315466`*^9, 3.857738995709507*^9}, {
  3.8577390317928376`*^9, 3.857739037568758*^9}, {3.857739087487305*^9, 
  3.8577391595690174`*^9}},ExpressionUUID->"50530063-f8f1-4f56-ba24-\
bb51951967e7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.9625`", 
      RowBox[{"-", "3.375`"}], "1.6875`", 
      RowBox[{"-", "0.1875`"}], 
      RowBox[{"-", "1.6875`"}], 
      RowBox[{"-", "1.6875`"}], 
      RowBox[{"-", "0.1875`"}], "1.6875`", 
      RowBox[{"-", "3.375`"}], "5.0625`"},
     {
      RowBox[{"-", "3.375`"}], "6.074999999999999`", 
      RowBox[{"-", "3.0374999999999996`"}], "0.3375`", "3.0374999999999996`", 
      "3.0374999999999996`", "0.3375`", 
      RowBox[{"-", "3.0374999999999996`"}], "6.074999999999999`", 
      RowBox[{"-", "9.1125`"}]},
     {"1.6875`", 
      RowBox[{"-", "3.0374999999999996`"}], "1.5187499999999998`", 
      RowBox[{"-", "0.16875`"}], 
      RowBox[{"-", "1.5187499999999998`"}], 
      RowBox[{"-", "1.5187499999999998`"}], 
      RowBox[{"-", "0.16875`"}], "1.5187499999999998`", 
      RowBox[{"-", "3.0374999999999996`"}], "4.55625`"},
     {
      RowBox[{"-", "0.1875`"}], "0.3375`", 
      RowBox[{"-", "0.16875`"}], "0.019140625`", "0.165234375`", 
      "0.165234375`", "0.019140625`", 
      RowBox[{"-", "0.16875`"}], "0.3375`", 
      RowBox[{"-", "0.5062500000000001`"}]},
     {
      RowBox[{"-", "1.6875`"}], "3.0374999999999996`", 
      RowBox[{"-", "1.5187499999999998`"}], "0.165234375`", "1.550390625`", 
      "1.550390625`", "0.165234375`", 
      RowBox[{"-", "1.5187499999999998`"}], "3.0374999999999996`", 
      RowBox[{"-", "4.55625`"}]},
     {
      RowBox[{"-", "1.6875`"}], "3.0374999999999996`", 
      RowBox[{"-", "1.5187499999999998`"}], "0.165234375`", "1.550390625`", 
      "1.550390625`", "0.165234375`", 
      RowBox[{"-", "1.5187499999999998`"}], "3.0374999999999996`", 
      RowBox[{"-", "4.55625`"}]},
     {
      RowBox[{"-", "0.1875`"}], "0.3375`", 
      RowBox[{"-", "0.16875`"}], "0.019140625`", "0.165234375`", 
      "0.165234375`", "0.019140625`", 
      RowBox[{"-", "0.16875`"}], "0.3375`", 
      RowBox[{"-", "0.5062500000000001`"}]},
     {"1.6875`", 
      RowBox[{"-", "3.0374999999999996`"}], "1.5187499999999998`", 
      RowBox[{"-", "0.16875`"}], 
      RowBox[{"-", "1.5187499999999998`"}], 
      RowBox[{"-", "1.5187499999999998`"}], 
      RowBox[{"-", "0.16875`"}], "1.5187499999999998`", 
      RowBox[{"-", "3.0374999999999996`"}], "4.55625`"},
     {
      RowBox[{"-", "3.375`"}], "6.074999999999999`", 
      RowBox[{"-", "3.0374999999999996`"}], "0.3375`", "3.0374999999999996`", 
      "3.0374999999999996`", "0.3375`", 
      RowBox[{"-", "3.0374999999999996`"}], "6.074999999999999`", 
      RowBox[{"-", "9.1125`"}]},
     {"5.0625`", 
      RowBox[{"-", "9.1125`"}], "4.55625`", 
      RowBox[{"-", "0.5062500000000001`"}], 
      RowBox[{"-", "4.55625`"}], 
      RowBox[{"-", "4.55625`"}], 
      RowBox[{"-", "0.5062500000000001`"}], "4.55625`", 
      RowBox[{"-", "9.1125`"}], "13.837500000000002`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.857739114663324*^9, 3.8577391378333144`*^9}, {
  3.857739224014618*^9, 
  3.8577392371894083`*^9}},ExpressionUUID->"b51456a9-31ed-47cb-8704-\
3f67adcded08"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"52.574999999999996`", 
      RowBox[{"-", "73.275`"}], "32.5875`", 
      RowBox[{"-", "3.9125`"}], 
      RowBox[{"-", "24.525`"}], 
      RowBox[{"-", "32.737500000000004`"}], 
      RowBox[{"-", "7.825`"}], "48.8625`", 
      RowBox[{"-", "89.62500000000001`"}], "97.87500000000001`"},
     {
      RowBox[{"-", "73.275`"}], "118.0125`", 
      RowBox[{"-", "54.449999999999996`"}], "6.8125`", "41.512499999999996`", 
      "50.62500000000001`", "10.100000000000001`", 
      RowBox[{"-", "67.725`"}], "126.33749999999999`", 
      RowBox[{"-", "157.95`"}]},
     {"32.5875`", 
      RowBox[{"-", "54.449999999999996`"}], "27.05625`", 
      RowBox[{"-", "3.7437500000000004`"}], 
      RowBox[{"-", "19.9125`"}], 
      RowBox[{"-", "21.09375`"}], 
      RowBox[{"-", "3.7`"}], "26.943749999999998`", 
      RowBox[{"-", "53.55`"}], "69.86250000000001`"},
     {
      RowBox[{"-", "3.9125`"}], "6.8125`", 
      RowBox[{"-", "3.7437500000000004`"}], "0.6208333333333333`", 
      "2.3062500000000004`", "1.7625000000000002`", "0.3104166666666667`", 
      RowBox[{"-", "2.4812499999999997`"}], "5.637499999999999`", 
      RowBox[{"-", "7.312500000000001`"}]},
     {
      RowBox[{"-", "24.525`"}], "41.512499999999996`", 
      RowBox[{"-", "19.9125`"}], "2.3062500000000004`", "18.05625`", 
      "19.40625`", "2.9812499999999997`", 
      RowBox[{"-", "22.6125`"}], "43.5375`", 
      RowBox[{"-", "60.75000000000001`"}]},
     {
      RowBox[{"-", "32.737500000000004`"}], "50.62500000000001`", 
      RowBox[{"-", "21.09375`"}], "1.7625000000000002`", "19.40625`", 
      "31.725`", "5.15625`", 
      RowBox[{"-", "35.60625`"}], "62.775000000000006`", 
      RowBox[{"-", "82.01249999999999`"}]},
     {
      RowBox[{"-", "7.825`"}], "10.100000000000001`", 
      RowBox[{"-", "3.7`"}], "0.3104166666666667`", "2.9812499999999997`", 
      "5.15625`", "1.5520833333333333`", 
      RowBox[{"-", "8.75`"}], "14.8`", 
      RowBox[{"-", "14.625000000000002`"}]},
     {"48.8625`", 
      RowBox[{"-", "67.725`"}], "26.943749999999998`", 
      RowBox[{"-", "2.4812499999999997`"}], 
      RowBox[{"-", "22.6125`"}], 
      RowBox[{"-", "35.60625`"}], 
      RowBox[{"-", "8.75`"}], "52.70625`", 
      RowBox[{"-", "91.57499999999999`"}], "100.23749999999998`"},
     {
      RowBox[{"-", "89.62500000000001`"}], "126.33749999999999`", 
      RowBox[{"-", "53.55`"}], "5.637499999999999`", "43.5375`", 
      "62.775000000000006`", "14.8`", 
      RowBox[{"-", "91.57499999999999`"}], "163.91250000000002`", 
      RowBox[{"-", "182.24999999999994`"}]},
     {"97.87500000000001`", 
      RowBox[{"-", "157.95`"}], "69.86250000000001`", 
      RowBox[{"-", "7.312500000000001`"}], 
      RowBox[{"-", "60.75000000000001`"}], 
      RowBox[{"-", "82.01249999999999`"}], 
      RowBox[{"-", "14.625000000000002`"}], "100.23749999999998`", 
      RowBox[{"-", "182.24999999999994`"}], "236.92499999999998`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.857739114663324*^9, 3.8577391378333144`*^9}, {
  3.857739224014618*^9, 
  3.857739237219696*^9}},ExpressionUUID->"4b2d367b-3493-47f8-a9bd-\
e9237bf9e35d"]
}, Open  ]]
},
WindowSize->{1904, 997},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.7 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2149, 59, 429, "Input",ExpressionUUID->"85d77932-1ad2-44d7-a984-1bd4727fd28b"],
Cell[2732, 83, 35069, 749, 331, "Output",ExpressionUUID->"3e65f29f-786f-4785-b06b-53e403b396e9"]
}, Open  ]],
Cell[37816, 835, 2776, 74, 520, "Input",ExpressionUUID->"0ac08ff6-5570-4f01-bea9-69a861f03949"],
Cell[40595, 911, 1556, 42, 158, "Input",ExpressionUUID->"e0938c9a-6fc4-42f7-bc29-7a01acda8d4d"],
Cell[42154, 955, 930, 24, 84, "Input",ExpressionUUID->"613b375c-9817-4d46-8776-002d5eeb225e"],
Cell[43087, 981, 4121, 103, 188, "Input",ExpressionUUID->"e4edd004-70fb-4f15-b1e5-4492d188c404"],
Cell[47211, 1086, 3744, 82, 281, "Input",ExpressionUUID->"a66f0b6b-ce18-40ce-ac1b-7d6b5e655dc8"],
Cell[50958, 1170, 1772, 37, 149, "Input",ExpressionUUID->"8004afab-6467-4451-ba45-6b01a26b6165"],
Cell[52733, 1209, 2531, 53, 257, "Input",ExpressionUUID->"632edba4-611e-4898-9e82-37a4c2b26ac9"],
Cell[55267, 1264, 3682, 87, 424, "Input",ExpressionUUID->"bf26baa3-5b1e-4253-915d-0f348b66b415"],
Cell[CellGroupData[{
Cell[58974, 1355, 1172, 34, 221, "Input",ExpressionUUID->"50530063-f8f1-4f56-ba24-bb51951967e7"],
Cell[60149, 1391, 3530, 83, 323, "Output",ExpressionUUID->"b51456a9-31ed-47cb-8704-3f67adcded08"],
Cell[63682, 1476, 3652, 83, 323, "Output",ExpressionUUID->"4b2d367b-3493-47f8-a9bd-e9237bf9e35d"]
}, Open  ]]
}
]
*)

