(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53489,       1221]
NotebookOptionsPosition[     52447,       1198]
NotebookOutlinePosition[     52822,       1214]
CellTagsIndexPosition[     52779,       1211]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"triangle", " ", "=", " ", 
   RowBox[{"Triangle", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary", "=", 
   RowBox[{
    RowBox[{"RegionBoundary", "[", "triangle", "]"}], "\[LeftDoubleBracket]", 
    "1", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodes", "=", 
   RowBox[{"Catenate", "[", 
    RowBox[{"Most", "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["j", "3"]}], ")"}], 
         RowBox[{
         "boundary", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
         "+", 
        RowBox[{
         FractionBox["j", "3"], 
         RowBox[{"boundary", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nodes", ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "3"], ",", 
      FractionBox["1", "3"]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "@", "nodes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
  RowBox[{"nodes", ",", "\[IndentingNewLine]", 
   RowBox[{"LabelingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"nodes", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"PointSize", "\[Rule]", "Large"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.85591696311981*^9, 3.8559170074066153`*^9}, {
   3.8559171420064907`*^9, 3.855917275754678*^9}, 
   3.855917333529746*^9},ExpressionUUID->"85d77932-1ad2-44d7-a984-\
1bd4727fd28b"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{0., 0.}, {0.3333333333333333, 0.}, {0.6666666666666666, 0.}, {
      1., 0.}, {0.6666666666666666, 0.3333333333333333}, {0.3333333333333333, 
      0.6666666666666666}, {0., 1.}, {0., 0.6666666666666666}, {0., 
      0.3333333333333333}, {0.3333333333333333, 
      0.3333333333333333}}]}, {}}, {}, {}, {{}, {}}, {{GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, {0., 0.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.3333333333333333, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.3333333333333333, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"2"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.6666666666666666, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.6666666666666666, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.6666666666666666, 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.6666666666666666, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"3"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.6666666666666666, 0.}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{0., 4.}, {1., 0.}], Offset[{0., 4.}, {1., 0.}], 
          Offset[{0., 6.}, {1., 0.}], Offset[{0., 6.}, {1., 0.}], 
          Offset[{0., 8.}, {1., 0.}], Offset[{0., 10.}, {1., 0.}], 
          Offset[{0., 12.}, {1., 0.}], Offset[{0., 12.}, {1., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{0., 4.}, {1., 0.}], Offset[{0., 4.}, {1., 0.}], 
          Offset[{0., 6.}, {1., 0.}], Offset[{0., 6.}, {1., 0.}], 
          Offset[{0., 8.}, {1., 0.}], Offset[{0., 10.}, {1., 0.}], 
          Offset[{0., 12.}, {1., 0.}], Offset[{0., 12.}, {1., 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{10.999999999999998`, 27.000000000000004`}, {1., 0.}], 
          Offset[{11.000000000000002`, 12.000000000000004`}, {1., 0.}], 
          Offset[{-10.999999999999998`, 11.999999999999996`}, {1., 0.}], 
          Offset[{-11.000000000000002`, 26.999999999999996`}, {1., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"4"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], Offset[{0., 19.5}, {1., 0.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"5"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.6666666666666666, 0.3333333333333333}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"6"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.6666666666666666}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 1.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 1.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 1.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 1.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"7"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, {0., 1.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 
           0.6666666666666666}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 
           0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"8"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0., 0.6666666666666666}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 
           0.3333333333333333}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 
           0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"9"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0., 0.3333333333333333}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{38.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{38.494480483301835`, 1.604059656000313}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.604059656000306}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"10"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{24.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.3333333333333333}], {0, 0}]}]}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Small,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.08]}, {
     Scaled[0.02], 
     Scaled[0.12]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8559172092326975`*^9, 3.8559172772199097`*^9}, 
   3.855917334289918*^9, 3.8559183587819247`*^9, 
   3.8559997084137044`*^9},ExpressionUUID->"0043e361-763c-42a9-b93e-\
a9c1b54d1e05"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"standardBasisFunctions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "2"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "2"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "3"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "3"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "2"], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       SuperscriptBox[
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "2"]}], "&"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
       "\[RightDoubleBracket]"}], "[", 
      RowBox[{"nodes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["H", "inv"], "=", 
   RowBox[{"Inverse", "@", "H"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    SuperscriptBox["H", "T"], "inv"], "=", 
   RowBox[{"Transpose", "@", 
    SubscriptBox["H", "inv"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8559173600415964`*^9, 
  3.855917389511634*^9}},ExpressionUUID->"0ac08ff6-5570-4f01-bea9-\
69a861f03949"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "list", " ", "of", " ", "shape", " ", "functions"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPsi]", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", "=", "i"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox[
               SuperscriptBox["H", "T"], "inv"], "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{
              "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], "@", "#"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Through", "[", 
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "//", " ", 
     "MatrixForm"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.855917614145997*^9, 3.855917620843938*^9}, {
  3.8559180511274242`*^9, 3.8559180546639385`*^9}, {3.8559996148585033`*^9, 
  3.855999620459361*^9}},ExpressionUUID->"e0938c9a-6fc4-42f7-bc29-\
7a01acda8d4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "proof", " ", "that", " ", "this", " ", "is", " ", "an", " ", 
     "interpolating", " ", "basis"}], " ", "-", " ", 
    RowBox[{"this", " ", "matrix", " ", "has", " ", "components", " ", 
     SubscriptBox["\[CapitalPsi]", "i"], 
     RowBox[{"(", 
      SubscriptBox["nodes", "j"], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Through", "[", 
        RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "]"}], "&"}], ",", 
      "nodes"}], "]"}], " ", "//", " ", "MatrixForm"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8559174308812513`*^9, 3.8559174317269907`*^9}, 
   3.855918059690153*^9, {3.8559996128223515`*^9, 
   3.855999613624449*^9}},ExpressionUUID->"613b375c-9817-4d46-8776-\
002d5eeb225e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Now", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
    " ", "is", " ", "what", " ", "in", " ", "the", " ", "linear", " ", "case",
     " ", "is", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
    " ", "and", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
    " ", "in", " ", "the", " ", "linear", " ", "case", " ", "is", " ", 
    RowBox[{
    "elementNodes", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
        "-", 
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
        "-", 
       RowBox[{
       "elementNodes", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"7", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"7", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"elementNodes", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "}"}]}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"innerMass", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "\[CapitalPsi]", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "[", 
            RowBox[{"{", 
             RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], 
           RowBox[{
            RowBox[{
            "\[CapitalPsi]", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "[", 
            RowBox[{"{", 
             RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Eta]", ",", "0", ",", 
            RowBox[{"1", "-", "\[Xi]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.85591918259512*^9}, {3.8559759719770875`*^9, 
   3.855975972543495*^9}, {3.855999881682604*^9, 3.855999893546773*^9}, {
   3.855999931360421*^9, 3.8559999335518575`*^9}, {3.8559999822938375`*^9, 
   3.856000004323064*^9}},ExpressionUUID->"e4edd004-70fb-4f15-b1e5-\
4492d188c404"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"{", 
    RowBox[{"Through", "[", 
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]T", "=", 
   RowBox[{"Transpose", "@", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"innerMass", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"\[Psi]T", ".", "\[Psi]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Eta]", ",", "0", ",", 
       RowBox[{"1", "-", "\[Xi]"}]}], "}"}], ",", 
     RowBox[{"AccuracyGoal", "\[Rule]", "8"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localMass", "[", 
   RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Abs", "@", 
    RowBox[{"Det", "@", 
     RowBox[{"J", "[", "elementNodes", "]"}]}]}], "innerMass"}]}]}], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.85591918259512*^9}, {3.8559759719770875`*^9, 
   3.855975972543495*^9}, {3.855999881682604*^9, 3.855999893546773*^9}, {
   3.855999931360421*^9, 3.8559999335518575`*^9}, {3.8559999822938375`*^9, 
   3.856000012267234*^9}, {3.8560001111516385`*^9, 
   3.856000119923855*^9}},ExpressionUUID->"8004afab-6467-4451-ba45-\
6b01a26b6165"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"grad\[Psi]", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grad\[Psi]T", "=", 
     RowBox[{"Transpose", "@", "grad\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "As", " ", "grad\[Psi]", " ", "is", " ", "not", " ", "a", " ", "constant",
      " ", "in", " ", "the", " ", "nonlinear", " ", "case", " ", "we", " ", 
     "can", " ", "no", " ", "longer", " ", "simplify", " ", "the", " ", 
     "integration"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localStiffness", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"Abs", "@", 
       RowBox[{"Det", "@", 
        RowBox[{"J", "[", "elementNodes", "]"}]}]}]], 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"grad\[Psi]T", ".", 
        RowBox[{"Transpose", "@", 
         RowBox[{"B", "[", "elementNodes", "]"}]}], ".", 
        RowBox[{"B", "[", "elementNodes", "]"}], ".", "grad\[Psi]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Eta]", ",", "0", ",", 
         RowBox[{"1", "-", "\[Xi]"}]}], "}"}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.855919171474184*^9}, {3.855975982809389*^9, 
   3.8559760004117975`*^9}, {3.8559986970941067`*^9, 3.855998720293186*^9}, {
   3.8559994185221596`*^9, 3.8559994607568784`*^9}, {3.8559994930764523`*^9, 
   3.855999493276621*^9}, {3.8559996928770337`*^9, 3.8559996978097773`*^9}, {
   3.856000007834848*^9, 
   3.8560000089216976`*^9}},ExpressionUUID->"632edba4-611e-4898-9e82-\
37a4c2b26ac9"]
},
WindowSize->{1904, 997},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>2. Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2149, 59, 493, "Input",ExpressionUUID->"85d77932-1ad2-44d7-a984-1bd4727fd28b"],
Cell[2732, 83, 35047, 749, 414, "Output",ExpressionUUID->"0043e361-763c-42a9-b93e-a9c1b54d1e05"]
}, Open  ]],
Cell[37794, 835, 2776, 74, 615, "Input",ExpressionUUID->"0ac08ff6-5570-4f01-bea9-69a861f03949"],
Cell[40573, 911, 1556, 42, 186, "Input",ExpressionUUID->"e0938c9a-6fc4-42f7-bc29-7a01acda8d4d"],
Cell[42132, 955, 867, 22, 99, "Input",ExpressionUUID->"613b375c-9817-4d46-8776-002d5eeb225e"],
Cell[43002, 979, 4774, 111, 448, "Input",ExpressionUUID->"e4edd004-70fb-4f15-b1e5-4492d188c404"],
Cell[47779, 1092, 1973, 44, 175, "Input",ExpressionUUID->"8004afab-6467-4451-ba45-6b01a26b6165"],
Cell[49755, 1138, 2688, 58, 296, "Input",ExpressionUUID->"632edba4-611e-4898-9e82-37a4c2b26ac9"]
}
]
*)

