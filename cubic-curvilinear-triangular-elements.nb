(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53296,       1216]
NotebookOptionsPosition[     52351,       1194]
NotebookOutlinePosition[     52727,       1210]
CellTagsIndexPosition[     52684,       1207]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"triangle", " ", "=", " ", 
   RowBox[{"Triangle", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary", "=", 
   RowBox[{
    RowBox[{"RegionBoundary", "[", "triangle", "]"}], "\[LeftDoubleBracket]", 
    "1", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodes", "=", 
   RowBox[{"Catenate", "[", 
    RowBox[{"Most", "/@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["j", "3"]}], ")"}], 
         RowBox[{
         "boundary", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
         "+", 
        RowBox[{
         FractionBox["j", "3"], 
         RowBox[{"boundary", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"nodes", ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "3"], ",", 
      FractionBox["1", "3"]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "@", "nodes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
  RowBox[{"nodes", ",", "\[IndentingNewLine]", 
   RowBox[{"LabelingFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"nodes", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"PointSize", "\[Rule]", "Large"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.85591696311981*^9, 3.8559170074066153`*^9}, {
   3.8559171420064907`*^9, 3.855917275754678*^9}, 
   3.855917333529746*^9},ExpressionUUID->"85d77932-1ad2-44d7-a984-\
1bd4727fd28b"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[Large], 
     AbsoluteThickness[1.6], 
     PointBox[{{0., 0.}, {0.3333333333333333, 0.}, {0.6666666666666666, 0.}, {
      1., 0.}, {0.6666666666666666, 0.3333333333333333}, {0.3333333333333333, 
      0.6666666666666666}, {0., 1.}, {0., 0.6666666666666666}, {0., 
      0.3333333333333333}, {0.3333333333333333, 
      0.3333333333333333}}]}, {}}, {}, {}, {{}, {}}, {{GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, {0., 0.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.3333333333333333, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.3333333333333333, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.3333333333333333, 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"2"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.6666666666666666, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.}], Offset[{4.870860362476378, 5.703044742000232}, {
           0.6666666666666666, 0.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.6666666666666666, 0.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.6666666666666666, 0.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.6666666666666666, 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"3"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.6666666666666666, 0.}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{0., 4.}, {1., 0.}], Offset[{0., 4.}, {1., 0.}], 
          Offset[{0., 6.}, {1., 0.}], Offset[{0., 6.}, {1., 0.}], 
          Offset[{0., 8.}, {1., 0.}], Offset[{0., 10.}, {1., 0.}], 
          Offset[{0., 12.}, {1., 0.}], Offset[{0., 12.}, {1., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{0., 4.}, {1., 0.}], Offset[{0., 4.}, {1., 0.}], 
          Offset[{0., 6.}, {1., 0.}], Offset[{0., 6.}, {1., 0.}], 
          Offset[{0., 8.}, {1., 0.}], Offset[{0., 10.}, {1., 0.}], 
          Offset[{0., 12.}, {1., 0.}], Offset[{0., 12.}, {1., 0.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{10.999999999999998`, 27.000000000000004`}, {1., 0.}], 
          Offset[{11.000000000000002`, 12.000000000000004`}, {1., 0.}], 
          Offset[{-10.999999999999998`, 11.999999999999996`}, {1., 0.}], 
          Offset[{-11.000000000000002`, 26.999999999999996`}, {1., 0.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"4"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], Offset[{0., 19.5}, {1., 0.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.6666666666666666, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.6666666666666666, 0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.6666666666666666, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"5"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.6666666666666666, 0.3333333333333333}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {
           0.3333333333333333, 0.6666666666666666}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"6"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.6666666666666666}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 1.}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 1.}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 1.}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 1.}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 1.}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 1.}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"7"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, {0., 1.}], {0, 0}]}], 
     GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.6666666666666666}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.6666666666666666}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 
           0.6666666666666666}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 
           0.6666666666666666}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 
           0.6666666666666666}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"8"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0., 0.6666666666666666}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0., 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {0., 
           0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{32.494480483301835`, 16.604059656000313`}, {0., 
           0.3333333333333333}], 
          Offset[{32.494480483301835`, 1.6040596560003122`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.6040596560003069`}, {0., 
           0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {0., 
           0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"9"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{21.494480483301835, 9.10405965600031}, \
{0., 0.3333333333333333}], {0, 0}]}], GraphicsGroupBox[{
       {GrayLevel[1], AbsoluteThickness[4], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], CapForm["Butt"], JoinForm[
        "Round"], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        BSplineCurveBox[{
         Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{3.2472402416509185`, 3.8020298280001548`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{4.870860362476378, 5.703044742000232}, {0.3333333333333333, 
           0.3333333333333333}], 
          Offset[{6.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{8.494480483301837, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 7.6040596560003095`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {GrayLevel[1], Opacity[
         NCache[
          Rational[2, 3], 0.6666666666666666]], EdgeForm[None], 
        PolygonBox[{
         Offset[{38.494480483301835`, 16.604059656000313`}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{38.494480483301835`, 1.604059656000313}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301837`, 1.604059656000306}, {
           0.3333333333333333, 0.3333333333333333}], 
          Offset[{10.494480483301833`, 16.604059656000306`}, {
           0.3333333333333333, 0.3333333333333333}]}]}, 
       {RGBColor[0.6666666666666666, 0.6666666666666666, 0.6666666666666666], 
        EdgeForm[None]}, {}, InsetBox[
        StyleBox[
         RotationBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"10"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          BoxRotation->0.],
         StripOnInput->False,
         LineOpacity->1,
         FrontFaceOpacity->1,
         BackFaceOpacity->1,
         Opacity->1,
         FontOpacity->1], 
        Offset[{24.494480483301835, 9.10405965600031}, \
{0.3333333333333333, 0.3333333333333333}], {0, 0}]}]}, {}}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Small,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.08]}, {
     Scaled[0.02], 
     Scaled[0.12]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8559172092326975`*^9, 3.8559172772199097`*^9}, 
   3.855917334289918*^9, 3.8559183587819247`*^9, 3.8559283927565928`*^9, 
   3.8559287499979763`*^9, 
   3.855929049849516*^9},ExpressionUUID->"4ff60892-d420-48a8-ba8d-\
97ce9d51518e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"standardBasisFunctions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "2"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "2"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "3"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "3"], "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "2"], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       SuperscriptBox[
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "2"]}], "&"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
       "\[RightDoubleBracket]"}], "[", 
      RowBox[{"nodes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["H", "inv"], "=", 
   RowBox[{"Inverse", "@", "H"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    SuperscriptBox["H", "T"], "inv"], "=", 
   RowBox[{"Transpose", "@", 
    SubscriptBox["H", "inv"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8559173600415964`*^9, 
  3.855917389511634*^9}},ExpressionUUID->"0ac08ff6-5570-4f01-bea9-\
69a861f03949"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "list", " ", "of", " ", "shape", " ", "functions"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPsi]", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", "=", "i"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox[
               SuperscriptBox["H", "T"], "inv"], "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{
              "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}], "@", "#"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Through", "[", 
      RowBox[{"\[CapitalPsi]", "[", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "//", " ", 
     "MatrixForm"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.855917614145997*^9, 3.855917620843938*^9}, {
   3.8559180511274242`*^9, 3.8559180546639385`*^9}, 
   3.855929033330675*^9},ExpressionUUID->"e0938c9a-6fc4-42f7-bc29-\
7a01acda8d4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "proof", " ", "that", " ", "this", " ", "is", " ", "an", " ", 
     "interpolating", " ", "basis"}], " ", "-", " ", 
    RowBox[{"this", " ", "matrix", " ", "has", " ", "components", " ", 
     SubscriptBox["\[CapitalPsi]", "i"], 
     RowBox[{"(", 
      SubscriptBox["nodes", "j"], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Through", "[", 
        RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "]"}], "&"}], ",", 
      "nodes"}], "]"}], " ", "//", " ", "MatrixForm"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8559174308812513`*^9, 3.8559174317269907`*^9}, 
   3.855918059690153*^9, 
   3.855929036354373*^9},ExpressionUUID->"613b375c-9817-4d46-8776-\
002d5eeb225e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "list", " ", "of", " ", "shape", " ", "functions", " ", "and", 
    " ", "its", " ", "gradient", " ", "when", " ", "evaluated", " ", "at", 
    " ", "\[Xi]", " ", "and", " ", "\[Eta]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]", "=", 
     RowBox[{"{", 
      RowBox[{"Through", "[", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]T", "=", 
     RowBox[{"Transpose", "@", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]T\[Psi]", "=", 
     RowBox[{"\[Psi]T", ".", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grad\[Psi]", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grad\[Psi]T", "=", 
     RowBox[{"Transpose", "@", "grad\[Psi]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"grad\[Psi]", ".", "elementNodes"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"By", " ", "taking", " ", "B"}], "=", 
     RowBox[{"|", "J", "|", " ", 
      RowBox[{
       SuperscriptBox["J", 
        RowBox[{"-", "1"}]], " ", "we", " ", "end", " ", "up", " ", 
       "calculating"}], " ", "|", "J", "|", 
      RowBox[{
       RowBox[{"/", "inverse"}], " ", "once", " ", "less", " ", "in", " ", 
       "the", " ", "integral", " ", "and", " ", "can", " ", "directly", " ", 
       "provide", " ", "formula", " ", "for", " ", "the", " ", "values"}]}]}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", "=", 
        RowBox[{"J", "@", "elementNodes"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"j", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"-", 
           RowBox[{"j", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"j", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"j", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Alternatively", " ", "-", " ", 
      RowBox[{
      "we", " ", "may", " ", "just", " ", "calculate", " ", "B", " ", "for", 
       " ", "a", " ", "given", " ", "Jacobian"}]}], ",", " ", 
     RowBox[{
     "since", " ", "we", " ", "will", " ", "have", " ", "to", " ", 
      "calculate", " ", "it", " ", "in", " ", "the", " ", "stiffness", " ", 
      "anyway"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BfromJ", "[", 
     RowBox[{"j_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"j", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"j", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"j", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"j", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.85591918259512*^9}, {3.855926363503072*^9, 
   3.855926391171403*^9}, {3.855926584147541*^9, 3.855926666548459*^9}, {
   3.8559267874353805`*^9, 3.8559269433841085`*^9}, {3.85592702032246*^9, 
   3.8559270444034386`*^9}, {3.855927168598097*^9, 3.855927172051813*^9}, {
   3.8559273339509077`*^9, 3.8559273347668095`*^9}, {3.8559277575872145`*^9, 
   3.8559278187893286`*^9}, {3.8559280259973125`*^9, 3.85592804767225*^9}, {
   3.855928170775955*^9, 3.855928232718207*^9}, {3.8559283554146504`*^9, 
   3.855928356229538*^9}, {3.855928680488125*^9, 3.8559286840396733`*^9}, {
   3.8559287211484647`*^9, 3.855928731758022*^9}, 3.855929016584271*^9, {
   3.8559290711203556`*^9, 
   3.8559291188533363`*^9}},ExpressionUUID->"e4edd004-70fb-4f15-b1e5-\
4492d188c404"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "jacobian", " ", "is", " ", "no", " ", "longer", " ", "a", " ",
     "constant", " ", "in", " ", "the", " ", "general", " ", 
    RowBox[{"case", ".", " ", "As"}], " ", "a", " ", "result", " ", "we", " ", 
    RowBox[{"don", "'"}], "t", " ", "have", " ", "\"\<constant\>\"", " ", 
    "integrals"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"localMass", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", "=", 
        RowBox[{"J", "@", "elementNodes"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"\[Psi]T\[Psi]", " ", 
         RowBox[{"Abs", "@", 
          RowBox[{"Det", "@", "j"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Eta]", ",", "0", ",", 
          RowBox[{"1", "-", "\[Xi]"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"localStiffness", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"j", "=", 
         RowBox[{"J", "@", "elementNodes"}]}], ",", "b", ",", "bT"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"b", "=", 
        RowBox[{"BfromJ", "@", "j"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bT", "=", 
        RowBox[{"Transpose", "@", "b"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"grad\[Psi]T", ".", "bT", ".", "b", ".", "grad\[Psi]"}], 
          " ", 
          FractionBox["1", 
           RowBox[{"Abs", "@", 
            RowBox[{"Det", "@", "j"}]}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Eta]", ",", "0", ",", 
           RowBox[{"1", "-", "\[Xi]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8559175110990925`*^9, 3.8559175400720325`*^9}, {
   3.8559176903931465`*^9, 3.8559177257259893`*^9}, {3.8559177634115257`*^9, 
   3.855917776605187*^9}, {3.855917819370779*^9, 3.8559178201554103`*^9}, {
   3.8559179245914135`*^9, 3.8559179265677996`*^9}, {3.8559180124504223`*^9, 
   3.855918106621934*^9}, {3.855918161525457*^9, 3.855918163253657*^9}, {
   3.8559182031221504`*^9, 3.855918311336273*^9}, 3.855918349437587*^9, {
   3.855918624575268*^9, 3.85591862519341*^9}, {3.8559186631246147`*^9, 
   3.855918695391884*^9}, {3.855918759567051*^9, 3.8559188303200607`*^9}, {
   3.855919077768056*^9, 3.855919171474184*^9}, {3.8559263788740587`*^9, 
   3.855926379496764*^9}, {3.8559264538987036`*^9, 3.8559264706222267`*^9}, {
   3.8559265131454067`*^9, 3.855926551287267*^9}, {3.855926600932041*^9, 
   3.8559266029803996`*^9}, {3.855926757633851*^9, 3.855926773067529*^9}, {
   3.855927074088623*^9, 3.8559271488339853`*^9}, {3.8559272103231177`*^9, 
   3.8559272122329683`*^9}, {3.855927607508975*^9, 3.855927698605973*^9}, {
   3.8559278379612293`*^9, 3.8559278582960434`*^9}, {3.8559279164812145`*^9, 
   3.8559279667731886`*^9}, {3.8559280601087627`*^9, 
   3.8559280801017303`*^9}, {3.8559282690242653`*^9, 
   3.8559282723897448`*^9}, {3.8559287392566986`*^9, 
   3.8559287400063105`*^9}},ExpressionUUID->"632edba4-611e-4898-9e82-\
37a4c2b26ac9"]
},
WindowSize->{1904, 997},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.7 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2149, 59, 429, "Input",ExpressionUUID->"85d77932-1ad2-44d7-a984-1bd4727fd28b"],
Cell[2732, 83, 35097, 750, 331, "Output",ExpressionUUID->"4ff60892-d420-48a8-ba8d-97ce9d51518e"]
}, Open  ]],
Cell[37844, 836, 2776, 74, 520, "Input",ExpressionUUID->"0ac08ff6-5570-4f01-bea9-69a861f03949"],
Cell[40623, 912, 1532, 42, 158, "Input",ExpressionUUID->"e0938c9a-6fc4-42f7-bc29-7a01acda8d4d"],
Cell[42158, 956, 841, 22, 84, "Input",ExpressionUUID->"613b375c-9817-4d46-8776-002d5eeb225e"],
Cell[43002, 980, 5750, 132, 547, "Input",ExpressionUUID->"e4edd004-70fb-4f15-b1e5-4492d188c404"],
Cell[48755, 1114, 3592, 78, 385, "Input",ExpressionUUID->"632edba4-611e-4898-9e82-37a4c2b26ac9"]
}
]
*)

