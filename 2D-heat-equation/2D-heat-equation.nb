(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44829,       1054]
NotebookOptionsPosition[     43240,       1027]
NotebookOutlinePosition[     43618,       1043]
CellTagsIndexPosition[     43575,       1040]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"square", " ", "=", " ", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"square", " ", "=", " ", 
     RowBox[{"Rectangle", "[", "]"}]}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary", "=", 
   RowBox[{
    RowBox[{"RegionBoundary", "[", "square", "]"}], "\[LeftDoubleBracket]", 
    "1", "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nodes", "=", 
   RowBox[{"Most", "@", "boundary"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Length", "@", "nodes"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
   RowBox[{"nodes", ",", "\[IndentingNewLine]", 
    RowBox[{"LabelingFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"nodes", ",", "#"}], "]"}], "&"}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"PointSize", "\[Rule]", "Large"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "\[IndentingNewLine]", "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.855132574680211*^9, 3.8551326093834515`*^9}, {
   3.855132693674719*^9, 3.8551327232864723`*^9}, {3.855132799743246*^9, 
   3.855133054814993*^9}, {3.8551331884963055`*^9, 3.855133213011741*^9}, {
   3.855133245286971*^9, 3.855133245967519*^9}, {3.8551333813912506`*^9, 
   3.855133399425208*^9}, {3.855133551684569*^9, 3.8551335733354087`*^9}, {
   3.855133622174522*^9, 3.8551336573539033`*^9}, {3.8551337547186947`*^9, 
   3.8551338789223*^9}, {3.8551339389211435`*^9, 3.8551339459898114`*^9}, {
   3.855134056495392*^9, 3.8551341128534207`*^9}, {3.8551342243375397`*^9, 
   3.8551344610971003`*^9}, {3.8551345342636886`*^9, 
   3.8551345538288264`*^9}, {3.8551346409075403`*^9, 
   3.8551346478378153`*^9}, {3.855134762237317*^9, 3.855134767540637*^9}, {
   3.8551348584452853`*^9, 3.855134868840858*^9}, {3.8551349160259657`*^9, 
   3.8551349845751376`*^9}, {3.855135058696909*^9, 3.855135061475986*^9}, {
   3.85513525778576*^9, 3.855135303271358*^9}, {3.8551353403325925`*^9, 
   3.8551353582988353`*^9}, {3.8551354155328445`*^9, 3.855135452152861*^9}, {
   3.8551354826537495`*^9, 3.8551355131628404`*^9}, {3.855135553541998*^9, 
   3.8551355559122734`*^9}, {3.855135596963092*^9, 3.8551356841178417`*^9}, 
   3.8551357706829433`*^9, {3.855135930095191*^9, 3.855136004672884*^9}, {
   3.85513611042063*^9, 3.8551361124440913`*^9}, {3.855136169923354*^9, 
   3.855136175595196*^9}, {3.8551364092834997`*^9, 3.8551364167641926`*^9}, {
   3.8551364730265408`*^9, 3.8551364860046673`*^9}, {3.8551369565690527`*^9, 
   3.855137013868618*^9}, {3.8551371528887033`*^9, 3.8551371900930257`*^9}, {
   3.8551372673650513`*^9, 3.8551372683807006`*^9}, {3.855137323708572*^9, 
   3.8551374266088314`*^9}, {3.855137501207449*^9, 3.855137534864267*^9}, {
   3.8551375744692526`*^9, 3.855137584725257*^9}, {3.855137730254588*^9, 
   3.8551377570717583`*^9}, {3.85513818643075*^9, 3.855138212185141*^9}, 
   3.858178969397629*^9, {3.8581790560269833`*^9, 3.858179059397614*^9}, {
   3.85817920731231*^9, 3.8581792126137714`*^9}, {3.8581794085189967`*^9, 
   3.8581794304572315`*^9}, {3.85817950340799*^9, 3.8581795063010626`*^9}, {
   3.8582066495921993`*^9, 3.8582066750705085`*^9}, {3.8582070219569955`*^9, 
   3.8582070227389235`*^9}},ExpressionUUID->"e64aa05b-3578-4cce-92bf-\
3c5725df8ecc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"standardBasisFunctions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
      "&"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "&"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
       "\[RightDoubleBracket]"}], "[", 
      RowBox[{"nodes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["H", "inv"], "=", 
   RowBox[{"Inverse", "@", "H"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox[
    SuperscriptBox["H", "T"], "inv"], "=", 
   RowBox[{"Transpose", "@", 
    SubscriptBox["H", "inv"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.855132574680211*^9, 3.8551326093834515`*^9}, {
   3.855132693674719*^9, 3.8551327232864723`*^9}, {3.855132799743246*^9, 
   3.855133054814993*^9}, {3.8551331884963055`*^9, 3.855133213011741*^9}, {
   3.855133245286971*^9, 3.855133245967519*^9}, {3.8551333813912506`*^9, 
   3.855133399425208*^9}, {3.855133551684569*^9, 3.8551335733354087`*^9}, {
   3.855133622174522*^9, 3.8551336573539033`*^9}, {3.8551337547186947`*^9, 
   3.8551338789223*^9}, {3.8551339389211435`*^9, 3.8551339459898114`*^9}, {
   3.855134056495392*^9, 3.8551341128534207`*^9}, {3.8551342243375397`*^9, 
   3.8551344610971003`*^9}, {3.8551345342636886`*^9, 
   3.8551345538288264`*^9}, {3.8551346409075403`*^9, 
   3.8551346478378153`*^9}, {3.855134762237317*^9, 3.855134767540637*^9}, {
   3.8551348584452853`*^9, 3.855134868840858*^9}, {3.8551349160259657`*^9, 
   3.8551349845751376`*^9}, {3.855135058696909*^9, 3.855135061475986*^9}, {
   3.85513525778576*^9, 3.855135303271358*^9}, {3.8551353403325925`*^9, 
   3.8551353582988353`*^9}, {3.8551354155328445`*^9, 3.855135452152861*^9}, {
   3.8551354826537495`*^9, 3.8551355131628404`*^9}, {3.855135553541998*^9, 
   3.8551355559122734`*^9}, {3.855135596963092*^9, 3.8551356841178417`*^9}, 
   3.8551357706829433`*^9, {3.855135930095191*^9, 3.855136004672884*^9}, {
   3.85513611042063*^9, 3.8551361124440913`*^9}, {3.855136169923354*^9, 
   3.855136175595196*^9}, {3.8551364092834997`*^9, 3.8551364167641926`*^9}, {
   3.8551364730265408`*^9, 3.8551364860046673`*^9}, {3.8551369565690527`*^9, 
   3.855137013868618*^9}, {3.8551371528887033`*^9, 3.8551371900930257`*^9}, {
   3.8551372673650513`*^9, 3.8551372683807006`*^9}, {3.855137323708572*^9, 
   3.8551374266088314`*^9}, {3.855137501207449*^9, 3.855137534864267*^9}, {
   3.8551375744692526`*^9, 3.855137584725257*^9}, {3.855137730254588*^9, 
   3.855137790982626*^9}, {3.85513812581544*^9, 3.855138139678568*^9}, {
   3.855138181044572*^9, 3.855138182428499*^9}, {3.8551382177226777`*^9, 
   3.855138219202299*^9}, {3.8581790969918404`*^9, 
   3.85817910119071*^9}},ExpressionUUID->"6c9ede6e-8914-46e9-ae6c-\
87872a199675"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalPsi]", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", "=", "i"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox[
             SuperscriptBox["H", "T"], "inv"], "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
           RowBox[{
            RowBox[{
            "standardBasisFunctions", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "@", "#"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "&"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Through", "[", 
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "]"}], "//", 
   " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.855132574680211*^9, 3.8551326093834515`*^9}, {
   3.855132693674719*^9, 3.8551327232864723`*^9}, {3.855132799743246*^9, 
   3.855133054814993*^9}, {3.8551331884963055`*^9, 3.855133213011741*^9}, {
   3.855133245286971*^9, 3.855133245967519*^9}, {3.8551333813912506`*^9, 
   3.855133399425208*^9}, {3.855133551684569*^9, 3.8551335733354087`*^9}, {
   3.855133622174522*^9, 3.8551336573539033`*^9}, {3.8551337547186947`*^9, 
   3.8551338789223*^9}, {3.8551339389211435`*^9, 3.8551339459898114`*^9}, {
   3.855134056495392*^9, 3.8551341128534207`*^9}, {3.8551342243375397`*^9, 
   3.8551344610971003`*^9}, {3.8551345342636886`*^9, 
   3.8551345538288264`*^9}, {3.8551346409075403`*^9, 
   3.8551346478378153`*^9}, {3.855134762237317*^9, 3.855134767540637*^9}, {
   3.8551348584452853`*^9, 3.855134868840858*^9}, {3.8551349160259657`*^9, 
   3.8551349845751376`*^9}, {3.855135058696909*^9, 3.855135061475986*^9}, {
   3.85513525778576*^9, 3.855135303271358*^9}, {3.8551353403325925`*^9, 
   3.8551353582988353`*^9}, {3.8551354155328445`*^9, 3.855135452152861*^9}, {
   3.8551354826537495`*^9, 3.8551355131628404`*^9}, {3.855135553541998*^9, 
   3.8551355559122734`*^9}, {3.855135596963092*^9, 3.8551356841178417`*^9}, 
   3.8551357706829433`*^9, {3.855135930095191*^9, 3.855136004672884*^9}, {
   3.85513611042063*^9, 3.8551361124440913`*^9}, {3.855136169923354*^9, 
   3.855136175595196*^9}, {3.8551364092834997`*^9, 3.8551364167641926`*^9}, {
   3.8551364730265408`*^9, 3.8551364860046673`*^9}, {3.8551369565690527`*^9, 
   3.855137013868618*^9}, {3.8551371528887033`*^9, 3.8551371900930257`*^9}, {
   3.8551372673650513`*^9, 3.8551372683807006`*^9}, {3.855137323708572*^9, 
   3.8551374266088314`*^9}, {3.855137501207449*^9, 3.855137534864267*^9}, {
   3.8551375744692526`*^9, 3.855137584725257*^9}, {3.855137730254588*^9, 
   3.855137790982626*^9}, {3.8551380907622976`*^9, 3.8551381055561914`*^9}, {
   3.85513815168231*^9, 3.85513815587302*^9}, {3.8551382253339725`*^9, 
   3.8551382315557284`*^9}, 3.855138303939831*^9, {3.8581791653132353`*^9, 
   3.8581791671029663`*^9}, {3.858179320234326*^9, 3.858179326718862*^9}, {
   3.8582070122894535`*^9, 
   3.8582070384147673`*^9}},ExpressionUUID->"2b7ef6c2-f4a9-4beb-9c50-\
84fc6b6c7082"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "For", " ", "proof", " ", "that", " ", "this", " ", "is", " ", "an", " ", 
     "interpolating", " ", "basis"}], " ", "-", " ", 
    RowBox[{"this", " ", "matrix", " ", "has", " ", "components", " ", 
     SubscriptBox["\[CapitalPsi]", "i"], 
     RowBox[{"(", 
      SubscriptBox["nodes", "j"], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Through", "[", 
        RowBox[{"\[CapitalPsi]", "[", "#", "]"}], "]"}], "&"}], ",", 
      "nodes"}], "]"}], " ", "//", " ", "MatrixForm"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.855137819826556*^9, 3.8551378304339557`*^9}, {
  3.8581794972849483`*^9, 3.8581794988766537`*^9}, {3.8582070151378107`*^9, 
  3.8582070330210867`*^9}},ExpressionUUID->"50710e72-5d1f-41e9-bb78-\
162691bc34ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "NIntegrate", " ", "is", " ", "bad", " ", "in", " ", "our", " ", "case", 
    " ", "since", " ", "it", " ", "does", " ", "a", " ", "lot", " ", "of", 
    " ", "unnecessary", " ", "work"}], " ", "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "know", " ", "that", " ", "we", " ", "are", " ", "using", " ", 
     "polynomials"}], " ", "=", 
    RowBox[{">", " ", 
     RowBox[{
     "quick", " ", "exact", " ", "gaussian", " ", "quadrature", " ", 
      "formulas"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"locWeights", "=", 
     RowBox[{"N", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              SqrtBox["3"]]}], ",", 
            RowBox[{"-", 
             FractionBox["1", 
              SqrtBox["3"]]}]}], "}"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["3"]], ",", 
            RowBox[{"-", 
             FractionBox["1", 
              SqrtBox["3"]]}]}], "}"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              SqrtBox["3"]]}], ",", 
            FractionBox["1", 
             SqrtBox["3"]]}], "}"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", 
             SqrtBox["3"]], ",", 
            FractionBox["1", 
             SqrtBox["3"]]}], "}"}], ",", "1"}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numericIntegrate", "[", "fSymb_", "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"locWeights", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
       RowBox[{"(", 
        RowBox[{"fSymb", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Xi]", "->", 
            RowBox[{"locWeights", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"\[Eta]", "->", 
            RowBox[{"locWeights", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}]}],
           "}"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "locWeights"}]}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.858206916423962*^9, 
  3.85820696684571*^9}},ExpressionUUID->"575608cf-ebde-4960-a550-\
b6432b49a429"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "list", " ", "of", " ", "shape", " ", "functions", " ", "and", 
    " ", "its", " ", "gradient", " ", "when", " ", "evaluated", " ", "at", 
    " ", "\[Xi]", " ", "and", " ", "\[Eta]"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]", "=", 
     RowBox[{"Simplify", "@", 
      RowBox[{"{", 
       RowBox[{"Through", "[", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], "}"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]T", "=", 
     RowBox[{"Transpose", "@", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]T\[Psi]", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"\[Psi]T", ".", "\[Psi]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grad\[Psi]", "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"Through", "[", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"grad\[Psi]T", "=", 
     RowBox[{"Transpose", "@", "grad\[Psi]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"grad\[Psi]", ".", "elementNodes"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"By", " ", "taking", " ", "B"}], "=", 
     RowBox[{"|", "J", "|", " ", 
      RowBox[{
       SuperscriptBox["J", 
        RowBox[{"-", "1"}]], " ", "we", " ", "end", " ", "up", " ", 
       "calculating"}], " ", "|", "J", "|", 
      RowBox[{
       RowBox[{"/", "inverse"}], " ", "once", " ", "less", " ", "in", " ", 
       "the", " ", "integral", " ", "and", " ", "can", " ", "directly", " ", 
       "provide", " ", "formula", " ", "for", " ", "the", " ", "values"}]}]}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", "=", 
        RowBox[{"J", "@", "elementNodes"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"j", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"-", 
           RowBox[{"j", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"j", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"j", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Alternatively", " ", "-", " ", 
      RowBox[{
      "we", " ", "may", " ", "just", " ", "calculate", " ", "B", " ", "for", 
       " ", "a", " ", "given", " ", "Jacobian"}]}], ",", " ", 
     RowBox[{
     "since", " ", "we", " ", "will", " ", "have", " ", "to", " ", 
      "calculate", " ", "it", " ", "in", " ", "the", " ", "stiffness", " ", 
      "anyway"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BfromJ", "[", 
     RowBox[{"j_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"j", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"-", 
         RowBox[{"j", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"j", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"j", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
     "}"}]}]}]}]], "Input",ExpressionUUID->"2e85d554-4de4-4f60-9dd1-\
7d75f7221215"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localMass", "[", 
   RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"numericIntegrate", "[", 
   RowBox[{
    RowBox[{"Abs", "@", 
     RowBox[{"Det", "@", 
      RowBox[{"J", "[", "elementNodes", "]"}]}]}], " ", 
    RowBox[{"\[Psi]T", ".", "\[Psi]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localStiffness", "[", 
   RowBox[{"elementNodes_", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"j", "=", 
       RowBox[{"J", "@", "elementNodes"}]}], ",", "b", ",", "bT", ",", "f"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{"BfromJ", "@", "j"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bT", "=", 
      RowBox[{"Transpose", "@", "b"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numericIntegrate", "[", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"Abs", "@", 
         RowBox[{"Det", "@", "j"}]}]], 
       RowBox[{"grad\[Psi]T", ".", "bT", ".", "b", ".", "grad\[Psi]"}]}], " ",
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8582073771605263`*^9, 3.8582074229750223`*^9}, {
  3.858207455390337*^9, 
  3.858207498816834*^9}},ExpressionUUID->"592eaa77-82cc-4d85-9bef-\
c17acd001ad2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMMatrix", "[", 
    RowBox[{
     RowBox[{"nodes_", "?", "ListQ"}], ",", 
     RowBox[{"elements_", "?", "ListQ"}], ",", "localFunction_", ",", 
     RowBox[{"nullNodes_:", 
      RowBox[{
       RowBox[{"{", "}"}], "?", "ListQ"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"globalMatrix", " ", "=", " ", 
        RowBox[{"SparseArray", "@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "@", "nodes"}], ",", 
             RowBox[{"Length", "@", "nodes"}]}], "}"}]}], "]"}]}]}], ",", " ",
        "element", ",", " ", "quality"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "@", "elements"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"element", " ", "=", " ", 
          RowBox[{
          "elements", "\[LeftDoubleBracket]", "k", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"quality", "=", 
          RowBox[{"localFunction", "@", 
           RowBox[{
           "nodes", "\[LeftDoubleBracket]", "element", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "@", "element"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "\[LessEqual]", 
               RowBox[{"Length", "@", "element"}]}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"globalMatrix", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                  "element", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{
                  "element", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "+=", 
                RowBox[{"quality", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "We", " ", "should", " ", "now", " ", "take", " ", "into", " ", 
         "account", " ", "that", " ", "some", " ", "of", " ", "the", " ", 
         "coefficients", " ", "will", " ", "have", " ", "to", " ", "be", " ", 
         "0", " ", "to", " ", "ensure", " ", "the", " ", "boundary", " ", 
         "condition", " ", "of", " ", "u"}], "=", "0"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "@", "nullNodes"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "@", "nodes"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"globalMatrix", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", 
               RowBox[{
               "nullNodes", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "=", 
             "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"globalMatrix", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{
               "nullNodes", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "j"}], 
              "\[RightDoubleBracket]"}], "=", "0"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"globalMatrix", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
            "nullNodes", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "nullNodes", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], "=", 
          "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "globalMatrix"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "function", " ", "that", " ", "assebles", " ", "the", " ", 
    "global", " ", "stiffness", " ", "matrix"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stiffnessMatrix", "[", 
    RowBox[{
     RowBox[{"nodes_", "?", "ListQ"}], ",", 
     RowBox[{"elements_", "?", "ListQ"}], ",", 
     RowBox[{"nullNodes_", "?", "ListQ"}]}], "]"}], ":=", 
   RowBox[{"FEMMatrix", "[", 
    RowBox[{
    "nodes", ",", "elements", ",", "localStiffness", ",", "nullNodes"}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "function", " ", "that", " ", "assebles", " ", "the", " ", 
    "global", " ", "mass", " ", "matrix"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massMatrix", "[", 
   RowBox[{
    RowBox[{"nodes_", "?", "ListQ"}], ",", 
    RowBox[{"elements_", "?", "ListQ"}], ",", 
    RowBox[{"nullNodes_", "?", "ListQ"}]}], "]"}], ":=", 
  RowBox[{"FEMMatrix", "[", 
   RowBox[{"nodes", ",", "elements", ",", "localMass", ",", "nullNodes"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.85821550526845*^9, 3.8582155068207827`*^9}, 
   3.8582458826063747`*^9},ExpressionUUID->"b0203e37-064f-4ab3-8c98-\
0bb7c9082cd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Discretization", " ", "of", " ", "the", " ", "region"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalOmega]", "=", 
     RowBox[{"Rectangle", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mesh", "=", 
     RowBox[{"ToElementMesh", "[", 
      RowBox[{"\[CapitalOmega]", ",", " ", 
       RowBox[{"\"\<MeshOrder\>\"", "\[Rule]", " ", "1"}], ",", 
       RowBox[{"MaxCellMeasure", "\[Rule]", "0.002"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"mesh", "[", "\"\<Wireframe\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"mesh", "[", 
       RowBox[{"\"\<Wireframe\>\"", "[", 
        RowBox[{"\"\<MeshElementIDStyle\>\"", "\[Rule]", "Red"}], "]"}], 
       "]"}], ",", 
      RowBox[{"mesh", "[", 
       RowBox[{"\"\<Wireframe\>\"", "[", 
        RowBox[{
         RowBox[{"\"\<MeshElement\>\"", "\[Rule]", "\"\<PointElements\>\""}], 
         ",", 
         RowBox[{"\"\<MeshElementIDStyle\>\"", "\[Rule]", "Blue"}]}], "]"}], 
       "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodes", " ", "=", " ", 
     RowBox[{"mesh", "[", "\"\<Coordinates\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elements", " ", "=", " ", 
     RowBox[{
      RowBox[{"mesh", "[", "\"\<MeshElements\>\"", "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boundary", " ", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"mesh", "[", "\"\<BoundaryElements\>\"", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boundary", "=", 
     RowBox[{"DeleteDuplicates", "[", "boundary", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.858207538420223*^9, 3.8582075572232323`*^9}, 
   3.8582076464270353`*^9, {3.8582456481522045`*^9, 3.8582456571370664`*^9}, {
   3.858245691926903*^9, 3.858245699758731*^9}, {3.858246332758562*^9, 
   3.858246335398385*^9}, {3.858246387533809*^9, 3.858246396125738*^9}, {
   3.8582470585050745`*^9, 3.8582471186098104`*^9}, 
   3.858294712170809*^9},ExpressionUUID->"266bf1f1-f554-4da0-a6bf-\
67dd49ae06b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["M", "0"], "=", 
   RowBox[{"massMatrix", "[", 
    RowBox[{"nodes", ",", "elements", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["M", "1"], "=", 
   RowBox[{"stiffnessMatrix", "[", 
    RowBox[{"nodes", ",", "elements", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.858207670996503*^9, 3.858207679933717*^9}, {
  3.858212425369879*^9, 3.858212427514717*^9}, {3.8582151008427334`*^9, 
  3.8582151494955816`*^9}, {3.858215483810416*^9, 3.858215489234322*^9}, {
  3.8582458772528543`*^9, 
  3.858245879060898*^9}},ExpressionUUID->"c7e7b94e-3a14-4c76-8519-\
dacb577c6032"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"initialU", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"]}], "\[LessEqual]", 
     FractionBox["1", "16"]}], ",", "100", ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", "[", "u_", "]"}], ":=", "u"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "[", "u_", "]"}], ":=", 
  FractionBox[
   SuperscriptBox["u", "2"], "2"]}]}], "Input",
 CellChangeTimes->{{3.858211413837885*^9, 3.858211446673599*^9}, {
   3.858211478891821*^9, 3.8582115186975937`*^9}, {3.8582116980880156`*^9, 
   3.858211709112243*^9}, {3.8582117505338125`*^9, 3.858211774651234*^9}, {
   3.858211810284973*^9, 3.8582118576030397`*^9}, {3.8582118977138996`*^9, 
   3.8582119060012712`*^9}, {3.8582121216602077`*^9, 
   3.8582122536455946`*^9}, {3.858212325142459*^9, 3.858212352112193*^9}, {
   3.8582123974387784`*^9, 3.858212405248642*^9}, {3.8582124469089737`*^9, 
   3.858212536177566*^9}, {3.858212628724513*^9, 3.858212672242197*^9}, {
   3.858212711823544*^9, 3.858212721256728*^9}, {3.858212759716568*^9, 
   3.858212909720262*^9}, {3.858213705715761*^9, 3.858213770739334*^9}, {
   3.8582138160569324`*^9, 3.8582138489565134`*^9}, {3.85821389241529*^9, 
   3.8582138957464037`*^9}, {3.858213964179768*^9, 3.8582140042489915`*^9}, {
   3.8582140406289*^9, 3.858214290263858*^9}, {3.858214324982358*^9, 
   3.8582144127737193`*^9}, {3.8582145101623726`*^9, 3.8582145425262156`*^9}, 
   3.8582152301235757`*^9},ExpressionUUID->"539ee970-741a-4538-9cb3-\
c12e56457950"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nonStandardFEM", "[", 
   RowBox[{
    RowBox[{"nodes_", "?", "ListQ"}], ",", 
    RowBox[{"elements_", "?", "ListQ"}], ",", 
    RowBox[{"nullNodes_", "?", "ListQ"}], ",", "T_", ",", "\[Tau]_", ",", 
    "uInit_", ",", "\[Alpha]_", ",", "G_", ",", "M0_", ",", "M1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "@", "nodes"}]}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"Ceiling", "@", 
        FractionBox["T", "\[Tau]"]}]}], ",", "sol", ",", "GVec", ",", 
      "jacobian", ",", "F"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sol", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "=", 
      RowBox[{"uInit", "/@", "nodes"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<", "m"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GVec", "=", 
         RowBox[{"G", "/@", 
          RowBox[{
          "sol", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"sol", "\[LeftDoubleBracket]", 
            RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
           RowBox[{
           "sol", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ns", "=", 
                 RowBox[{"LinearSolve", "[", 
                  RowBox[{"M0", ",", 
                   RowBox[{
                    RowBox[{"M0", ".", 
                    RowBox[{"sol", "\[LeftDoubleBracket]", 
                    RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{"\[Tau]", " ", 
                    RowBox[{"M1", ".", "GVec"}]}]}]}], "]"}]}], ")"}], "-", 
               RowBox[{"sol", "\[LeftDoubleBracket]", 
                RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
             ">", "0.1"}], ",", 
            RowBox[{
             RowBox[{"sol", "\[LeftDoubleBracket]", 
              RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
             "ns"}]}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sol", "\[LeftDoubleBracket]", 
          RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"M0", ",", 
           RowBox[{
            RowBox[{"M0", ".", 
             RowBox[{
             "sol", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
            "-", 
            RowBox[{"\[Tau]", " ", 
             RowBox[{"M1", ".", "GVec"}]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "5"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"jacobian", "=", 
            RowBox[{"M0", "+", 
             RowBox[{"M1", ".", 
              RowBox[{"DiagonalMatrix", "[", 
               RowBox[{"\[Alpha]", "/@", 
                RowBox[{"sol", "\[LeftDoubleBracket]", 
                 RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], 
               "]"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"jacobian", "=", 
              RowBox[{"M0", "+", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"M1", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
                  RowBox[{"\[Alpha]", "[", 
                   RowBox[{"sol", "\[LeftDoubleBracket]", 
                    RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], 
                   "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"F", "=", 
            RowBox[{
             RowBox[{"M0", ".", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{
                 RowBox[{"sol", "\[LeftDoubleBracket]", 
                  RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "sol", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], "\[Tau]"], ")"}]}], "+", 
             RowBox[{"M1", ".", 
              RowBox[{"(", 
               FractionBox[
                RowBox[{
                 RowBox[{"G", "/@", 
                  RowBox[{"sol", "\[LeftDoubleBracket]", 
                   RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], "+", 
                 "GVec"}], "2"], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sol", "\[LeftDoubleBracket]", 
             RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"sol", "\[LeftDoubleBracket]", 
              RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"jacobian", ".", "F"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "sol"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.858211413837885*^9, 3.858211446673599*^9}, {
   3.858211478891821*^9, 3.8582115186975937`*^9}, {3.8582116980880156`*^9, 
   3.858211709112243*^9}, {3.8582117505338125`*^9, 3.858211774651234*^9}, {
   3.858211810284973*^9, 3.8582118576030397`*^9}, {3.8582118977138996`*^9, 
   3.8582119060012712`*^9}, {3.8582121216602077`*^9, 
   3.8582122536455946`*^9}, {3.858212325142459*^9, 3.858212352112193*^9}, {
   3.8582123974387784`*^9, 3.858212405248642*^9}, {3.8582124469089737`*^9, 
   3.858212536177566*^9}, {3.858212628724513*^9, 3.858212672242197*^9}, {
   3.858212711823544*^9, 3.858212721256728*^9}, {3.858212759716568*^9, 
   3.858212909720262*^9}, {3.858213705715761*^9, 3.858213770739334*^9}, {
   3.8582138160569324`*^9, 3.8582138489565134`*^9}, {3.85821389241529*^9, 
   3.8582138957464037`*^9}, {3.858213964179768*^9, 3.8582140042489915`*^9}, {
   3.8582140406289*^9, 3.858214290263858*^9}, {3.858214324982358*^9, 
   3.8582144127737193`*^9}, {3.8582145101623726`*^9, 
   3.8582145425262156`*^9}, {3.858214609100989*^9, 3.8582146116376815`*^9}, 
   3.8582146930655236`*^9, {3.8582149781651363`*^9, 3.858214981260742*^9}, {
   3.8582151962961807`*^9, 3.858215196640086*^9}, {3.8582154503048725`*^9, 
   3.8582154539113894`*^9}, 3.8582459779086637`*^9, {3.8582460339472313`*^9, 
   3.858246035851445*^9}, 3.858246132457014*^9, {3.8582462690338326`*^9, 
   3.8582462771298046`*^9}, 3.8582464261894703`*^9, {3.8582464812202854`*^9, 
   3.8582464850760508`*^9}, {3.858247033344977*^9, 3.858247035352002*^9}, {
   3.8582472035418186`*^9, 3.8582472626373405`*^9}, {3.8582476503858857`*^9, 
   3.858247658594596*^9}, {3.8582580372980995`*^9, 3.8582582026648407`*^9}, {
   3.8582582870816917`*^9, 3.8582582968171587`*^9}, 3.858258397635285*^9, {
   3.8582584809655304`*^9, 3.8582584813278227`*^9}, {3.8582585126977477`*^9, 
   3.858258531584633*^9}, 
   3.858294706683818*^9},ExpressionUUID->"c7d38d9f-7216-4b9e-b1dc-\
ed40de3b312c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Solve", " ", "the", " ", "equation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", "0.02"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Tau]", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"nonStandardFEM", "[", 
      RowBox[{"nodes", ",", "elements", ",", 
       RowBox[{"{", "}"}], ",", "T", ",", "\[Tau]", ",", "initialU", ",", 
       "\[Alpha]", ",", "G", ",", 
       SubscriptBox["M", "0"], ",", 
       SubscriptBox["M", "1"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"nodes", ",", 
            RowBox[{
            "q", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
           "}"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "q"}]}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.858214870300726*^9, 3.8582148780132875`*^9}, {
   3.858214943238459*^9, 3.8582149528225603`*^9}, {3.858215186052886*^9, 
   3.8582152863211803`*^9}, {3.858215456431823*^9, 3.858215457925871*^9}, {
   3.858245601114669*^9, 3.858245601657672*^9}, {3.8582459575110865`*^9, 
   3.8582459921554127`*^9}, {3.858246028407873*^9, 3.858246031687504*^9}, {
   3.858246138781723*^9, 3.85824613977348*^9}, 3.858246221872244*^9, 
   3.8582464034547687`*^9, {3.8582474150067577`*^9, 3.8582474157261972`*^9}, {
   3.858247512831936*^9, 3.85824751452242*^9}, 3.858258400009518*^9, {
   3.858294745302018*^9, 
   3.858294763266543*^9}},ExpressionUUID->"537fcbc0-f825-4985-bdf6-\
ff0ae95c09f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Contour", " ", "plot", " ", "of", " ", "the", " ", "solution"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
        "[", 
        RowBox[{"x", ",", "y"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLabel", "\[Rule]", "\"\<Contour plot of u\>\""}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", 
      RowBox[{"Length", "@", "u"}], ",", "1"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8582153274626155`*^9, 
  3.8582153878915825`*^9}},ExpressionUUID->"8f125c38-32b1-4cdb-8077-\
6c362907ad79"]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.7 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3795, 75, 347, "Input",ExpressionUUID->"e64aa05b-3578-4cce-92bf-3c5725df8ecc"],
Cell[4356, 97, 3599, 71, 314, "Input",ExpressionUUID->"6c9ede6e-8914-46e9-ae6c-87872a199675"],
Cell[7958, 170, 3402, 66, 125, "Input",ExpressionUUID->"2b7ef6c2-f4a9-4beb-9c50-84fc6b6c7082"],
Cell[11363, 238, 906, 23, 84, "Input",ExpressionUUID->"50710e72-5d1f-41e9-bb78-162691bc34ac"],
Cell[12272, 263, 2835, 84, 201, "Input",ExpressionUUID->"575608cf-ebde-4960-a550-b6432b49a429"],
Cell[15110, 349, 4476, 116, 514, "Input",ExpressionUUID->"2e85d554-4de4-4f60-9dd1-7d75f7221215"],
Cell[19589, 467, 1329, 35, 286, "Input",ExpressionUUID->"592eaa77-82cc-4d85-9bef-c17acd001ad2"],
Cell[20921, 504, 6365, 151, 1007, "Input",ExpressionUUID->"b0203e37-064f-4ab3-8c98-0bb7c9082cd3"],
Cell[27289, 657, 2493, 61, 347, "Input",ExpressionUUID->"266bf1f1-f554-4da0-a6bf-67dd49ae06b0"],
Cell[29785, 720, 723, 18, 83, "Input",ExpressionUUID->"c7e7b94e-3a14-4c76-8519-dacb577c6032"],
Cell[30511, 740, 1671, 34, 195, "Input",ExpressionUUID->"539ee970-741a-4538-9cb3-c12e56457950"],
Cell[32185, 776, 8050, 174, 908, "Input",ExpressionUUID->"c7d38d9f-7216-4b9e-b1dc-ed40de3b312c"],
Cell[40238, 952, 1896, 44, 182, "Input",ExpressionUUID->"537fcbc0-f825-4985-bdf6-ff0ae95c09f4"],
Cell[42137, 998, 1099, 27, 281, "Input",ExpressionUUID->"8f125c38-32b1-4cdb-8077-6c362907ad79"]
}
]
*)

